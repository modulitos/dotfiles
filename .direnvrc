# readme:
# https://github.com/direnv/direnv/blob/master/man/direnv-stdlib.1.md

# example usage in .envrc file:
# use go go1.17
use_go() {
  # By default, this will add "$HOME/sdk/$1/bin" to PATH.
  # Is there a way to use "$HOME/go/bin/go1.17" instead?

  # golang versions get installed to the sdk dir:
  # https://golang.org/doc/manage-install
  local go_dir=$HOME/sdk/$1
  load_prefix "$go_dir"
  layout go
}

use_istioctl() {
  local istioctl_dir=$HOME/istioctl/$1
  load_prefix "$istioctl_dir"
}

use_helm() {
  local helm_dir=$HOME/helm/$1
  load_prefix "$helm_dir"
}

use_kustomize() {
  local kustomize_dir=$HOME/kustomize/$1
  load_prefix "$kustomize_dir"
}

use_node() {
  # https://gist.github.com/gudleik/7ae3ef00f42440671f16
  #
  # Either use node version specified in package.json:
  # use node package.json
  # Or a specific version:
  # use node 5.0.0
  #
  layout node

  local node_version=$1

  if [ "$node_version" == "package.json" ]; then
    # Requires jq: `brew install jq`
    node_version=$(jq --raw-output .engines.node package.json | tr -d "<=> ")
  fi

  local node_path=${NODE_DIR:-$HOME/sdk/n/versions/node}
  # This is what the path should look like:
  #
  # ‚ùØ ls -l ~/sdk/n/versions/node
  # total 0
  # drwxr-xr-x  9 lucas  staff  288 Feb 24 11:33 10.16.0
  # drwxr-xr-x  9 lucas  staff  288 Feb 24 10:50 12.13.1

  if [ -x "$node_path/$node_version/bin/node" ]; then
    PATH_add "$node_path/$node_version/bin"
  elif [ -x "$node_path/v$node_version/bin/node" ]; then
    # Support nvm users (nvm prefixes versions with 'v')
    PATH_add "$node_path/v$node_version/bin"
  else
    echo "!!! Node.js version $node_version is not installed"
  fi

  export NODE_PATH=./node_modules
}


# python: currently using pyenv:
# https://stackabuse.com/managing-python-environments-with-direnv-and-pyenv/
# ie: layout pyenv 3.9.7
